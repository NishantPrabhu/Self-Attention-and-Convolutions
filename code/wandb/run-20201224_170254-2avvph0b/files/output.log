
[INFO] No saved state found, starting fresh
[Train epoch] 1 - [LR] 0.0067:   0%|          | 0/500 [00:00<?, ?it/s]
torch.Size([100, 64, 8, 8])
Traceback (most recent call last):
  File "main.py", line 46, in <module>
    model.train(train_loader, val_loader)
  File "/home/nishant/Desktop/Desktop/Papers2code/Implementations/Self-Attention-and-Convolutions/code/trainer.py", line 179, in train
    train_loss, train_correct = self.train_one_step(batch)
  File "/home/nishant/Desktop/Desktop/Papers2code/Implementations/Self-Attention-and-Convolutions/code/trainer.py", line 52, in train_one_step
    out = self.clf_head(self.encoder(self.conv_bottom(img), return_attn_scores=False))
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/nishant/Desktop/Desktop/Papers2code/Implementations/Self-Attention-and-Convolutions/code/networks.py", line 289, in forward
    x, att = self.blocks[i](x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/nishant/Desktop/Desktop/Papers2code/Implementations/Self-Attention-and-Convolutions/code/networks.py", line 271, in forward
    x, att_scores = self.attention(x, return_attn_scores=True)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/nishant/Desktop/Desktop/Papers2code/Implementations/Self-Attention-and-Convolutions/code/networks.py", line 46, in forward
    Q = self.query(x).view(bs, h, w, self.heads, -1)							# Q -> (bs, h, w, heads, model_dim)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/linear.py", line 91, in forward
    return F.linear(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/functional.py", line 1676, in linear
    output = input.matmul(weight.t())
RuntimeError: mat1 dim 1 must match mat2 dim 0
